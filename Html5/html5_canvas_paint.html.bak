<!DOCTYPE HTML>
<html>
<head>
	<title>Html5 Canvas arc</title>
	<script src="http://yui.yahooapis.com/2.8.2r1/build/yahoo-dom-event/yahoo-dom-event.js"></script>	
</head>
<body>
<div>
	<div>
	Paint_Options&nbsp;&nbsp;
	
	color:<select id="color">
			<option value="black">black</option>
			<option value="red">red</option>
			<option value="blue">blue</option>
			<option value="green">green</option>
		</select>
	style:<select id="join">
			<option value="miter">miter</option>
			<option value="round">round</option>
			<option value="bevel">bevel</option>
		</select>
	width:<select id="width">
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4">4</option>
		</select>
	</div>
	<canvas id="c" height="800" width="1024" style="border:1px solid black;"></canvas>
</div>
<script type="text/javascript">
    var Dom = YAHOO.util.Dom;
    var Event = YAHOO.util.Event;
	var c = Dom.get('c');//取得Dom元素
    var context = c.getContext("2d");//拿到Canvas的上下文 目前好像只支持2D渲染
    
	var clickX = new Array();
	var clickY = new Array();
	var clickDrag = new Array();
    var paint = false; 
    
	Event.addListener(c,'mousedown',function(e){
		var e = e || window.event;
		var mouseX = Event.getPageX(e);
		var mouseY = Event.getPageY(e);
        
		paint = true;
		addClick(mouseX,mouseY);
		redraw();
	});

	Event.addListener(c,'mousemove',function(e){
		var e = e || window.event;
		if(paint){
			var mouseX = Event.getPageX(e);
			var mouseY = Event.getPageY(e);
			addClick(mouseX,mouseY,true);
			redraw();
		}
	});
	
	Event.addListener(c,'mouseup',function(e){
		paint = false;
	});

	Event.addListener(c,'mouseleave',function(e){
		paint = false;
	});

	function addClick(x,y,dragging){
		clickX.push(x);
		clickY.push(y);
		clickDrag.push(dragging);
	}

	function redraw(){
		context.strokeStyle = Dom.get("color").value;
		context.lineJoin = Dom.get("join").value;
		context.lineWidth = Dom.get("width").value;
        
		context.save();

		for(var i=0; i < clickX.length; i++){
			context.beginPath();
			if(clickDrag[i] && i!=0){
				context.moveTo(clickX[i-1], clickY[i-1]);
			}else{
				context.moveTo(clickX[i]-1, clickY[i]);
			}
				context.lineTo(clickX[i], clickY[i]);
			context.closePath();
			context.stroke();
		}
	}
</script>

</body>
</html>